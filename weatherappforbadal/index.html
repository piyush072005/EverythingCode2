<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather App</title>
    <link rel="stylesheet" href="style.css">
    <script src="script.js"></script>
        <script>
            async function getWeather(city) {
                if (!API_KEY) {
                    alert('Please add your OpenWeatherMap API key to use this app.\n\nGet a free key at: https://openweathermap.org/api');
                    return;
                }

                weatherInfo.style.display = 'none';
                error.style.display = 'none';
                loading.style.display = 'block';

                try {
                    // Use the current weather endpoint and request metric units
                    const url = `https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(city)}&units=metric&appid=${API_KEY}`;
                    const response = await fetch(url);

                    if (!response.ok) {
                        // If the city is not found the API returns 404
                        throw new Error('City not found');
                    }

                    const data = await response.json();

                    // Safely read fields and update the UI
                    const temp = data.main && typeof data.main.temp === 'number' ? Math.round(data.main.temp) : '--';
                    const feels = data.main && typeof data.main.feels_like === 'number' ? Math.round(data.main.feels_like) : '--';
                    const humidity = data.main && typeof data.main.humidity === 'number' ? `${data.main.humidity}%` : '--%';
                    const windKmh = data.wind && typeof data.wind.speed === 'number' ? `${Math.round(data.wind.speed * 3.6)} km/h` : '-- km/h';
                    const desc = data.weather && data.weather[0] && data.weather[0].description ? data.weather[0].description : '';
                    const icon = data.weather && data.weather[0] && data.weather[0].icon ? data.weather[0].icon : '';

                    document.getElementById('temperature').textContent = `${temp}¬∞C`;
                    document.getElementById('cityName').textContent = data.name || city;
                    document.getElementById('description').textContent = desc;
                    document.getElementById('humidity').textContent = humidity;
                    document.getElementById('windSpeed').textContent = windKmh;
                    document.getElementById('feelsLike').textContent = `${feels}¬∞C`;
                    document.getElementById('weatherIcon').textContent = getWeatherIcon(icon);

                    loading.style.display = 'none';
                    weatherInfo.style.display = 'block';
                } catch (err) {
                    console.error('getWeather error:', err);
                    loading.style.display = 'none';
                    error.style.display = 'block';
                }
            }
        </script>

</head>
<body>
    <div class="container">
        <h1>üå§Ô∏è Weather App</h1>
        
        <div class="search-box">
            <input type="text" id="cityInput" placeholder="Enter city name..." />
            <button id="searchBtn">Search</button>
        </div>

        <div class="loading" id="loading">Loading...</div>
        <div class="error" id="error">City not found. Please try again.</div>

        <div class="weather-info" id="weatherInfo">
            <div class="weather-icon" id="weatherIcon">‚òÄÔ∏è</div>
            <div class="temperature" id="temperature">--¬∞C</div>
            <div class="city-name" id="cityName">--</div>
            <div class="description" id="description">--</div>
            
            <div class="details">
                <div class="detail-item">
                    <div class="detail-label">Humidity</div>
                    <div class="detail-value" id="humidity">--%</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Wind Speed</div>
                    <div class="detail-value" id="windSpeed">-- km/h</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Feels Like</div>
                    <div class="detail-value" id="feelsLike">--¬∞C</div>
                </div>
            </div>
        </div>
    </div>

</body>
</html>